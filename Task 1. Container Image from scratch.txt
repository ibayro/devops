#Preconditions

mkdir demo
mkdir rootfs
docker run busybox
docker images
docker ps -a
docker export <CONTAINER ID> | tar xf - -C rootfs
ll rootfs
ll rootfs/bin
sudo \

#Unshare in practice

unshare -i -m -n -p -u -U --mount-proc -R rootfs -f sh
id
ip a
ps xa
ls -l /
{exit}

#runc spec

runc spec
ll
sudo runc run demo
ip a
ps xa
ls -l /
ls /bin
{exit}

#Config

<.config.json> 
10 str - "sh", "-c", "while true; do { echo -e 'HTTP/1.1 200 OK\n\n Version: 1.0.0'; } | nc -vlp 8080; done"
4 str "false"
143 str "type": "network",
144 	   "path" "/var/run/netns/runc"	

#Container check

sudo runc run demo
sudo runc ps demo
sudo runc kill demo KILL

#Adding network settings

sudo ip netns add runc
sudo runc run demo
sudo bash
#brctl addbr runc0
#ip link set runc0 up
#ip addr add 192.168.0.1/24 dev runc0
#ip link add name veth-host type veth peer name veth-guest
#ip link set veth-host up
#brctl addif runc0 veth-host
#ip link set veth-guest netns runc
#ip netns exec runc ip link set veth-guest name eth1
#ip netns exec runc ip addr add 192.168.0.2/24 dev eth1
#ip netns exec runc ip link set eth1 up
#ip netns exec runc ip route add default via 192.168.0.1
#ping 192.168.0.1
#ping 192.168.0.2
exit

#Checking the container's performance
sudo runc run demo 
{open new terminal and enter curl 192.168.0.2:8080}

https://asciinema.org/a/hP1MB1K7Ft55O3XVE9vQnJ9Id - live coding session to start a docker container from scratch in an isolated environment (unshare)

https://asciinema.org/a/583681 - Docker container efficiency analysis performed by dive tool